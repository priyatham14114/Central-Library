sap.ui.define(["./baseController","sap/ui/core/Fragment","sap/m/MessageToast","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel"],function(e,i,s,t,o,n){"use strict";return e.extend("com.app.centrallibrary.controller.loginView",{onInit:function(){debugger;const e=new n({userName:"",userid:"",userpassword:""});this.getView().setModel(e,"oNewUserRegister")},onLoginPress:async function(){if(!this.oLoginDailogPopUp){this.oLoginDailogPopUp=await this.loadFragment("loginPopup")}this.oLoginDailogPopUp.open()},onCloseLoginDailog:function(){if(this.oLoginDailogPopUp.isOpen()){this.oLoginDailogPopUp.close()}},onUserLoginPress:function(){var e=this.getView();var i=e.byId("idUserIDInput").getValue();var n=e.byId("idPasswordInput").getValue();if(!i||!n){s.show("please enter required Credentials");return}var r=this.getView().getModel();var a=r.bindList("/UserLogin");a.filter([new t("userid",o.EQ,i),new t("userpassword",o.EQ,n)]);a.requestContexts().then(function(e){debugger;if(e.length>0){var i=e[0].getObject().ID;var t=e[0].getObject().typeOfUser;if(t==="Admin"){s.show("Login Successful");var o=this.getOwnerComponent().getRouter();o.navTo("RouteAdminView",{userId:i});var n=this.getView();n.byId("idUserIDInput").setValue("");n.byId("idPasswordInput").setValue("")}else{s.show("Login Successful");var o=this.getOwnerComponent().getRouter();o.navTo("RouteUserView",{userId:i});var n=this.getView();n.byId("idUserIDInput").setValue("");n.byId("idPasswordInput").setValue("")}}else{s.show("Invalid username or password.")}}.bind(this)).catch(function(){s.show("An error occurred during login.")})},onSignUpPress:async function(){if(!this.oSignUpDialog){this.oSignUpDialog=await this.loadFragment("Signup")}this.oSignUpDialog.open()},onCreateAccount:function(){debugger;const e=this.getView().byId("idSignUpUserName").getValue(),i=this.getView().byId("idSignUpUserIdVal").getValue(),n=this.getView().byId("idSignUpUserPassword").getValue(),r=this.getView().byId("idSignUpUserConfirmPasswordval").getValue(),a=this;if(e&&i&&n){debugger;const e=this.getView().getModel().bindList("/UserLogin");var g=this.getView().getModel("oNewUserRegister").getData();if(n===r){var d=this.getView().getModel();var l=d.bindList("/UserLogin");l.filter([new t("userid",o.EQ,i)]);l.requestContexts().then(function(i){debugger;if(i.length>0){s.show("User ID already exists")}else{e.create(g);s.show("Registration Successfull");a.oSignUpDialog.close();a.getView().byId("idSignUpUserName").setValue("");a.getView().byId("idSignUpUserIdVal").setValue("");a.getView().byId("idSignUpUserPassword").setValue("");a.getView().byId("idSignUpUserConfirmPasswordval").setValue("")}})}else{s.show("password must match")}}else{s.show("Enter all required fields ")}},onSignUpCancel:function(){if(this.oSignUpDialog.isOpen()){this.oSignUpDialog.close()}}})});